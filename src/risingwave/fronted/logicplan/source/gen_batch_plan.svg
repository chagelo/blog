<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: G Pages: 1 -->
<svg width="1459pt" height="327pt"
 viewBox="0.00 0.00 1458.50 327.15" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 323.15)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-323.15 1454.5,-323.15 1454.5,4 -4,4"/>
<!-- gbl -->
<g id="node1" class="node">
<title>gbl</title>
<path fill="none" stroke="black" d="M89.5,-138.5C89.5,-138.5 12,-138.5 12,-138.5 6,-138.5 0,-132.5 0,-126.5 0,-126.5 0,-114.5 0,-114.5 0,-108.5 6,-102.5 12,-102.5 12,-102.5 89.5,-102.5 89.5,-102.5 95.5,-102.5 101.5,-108.5 101.5,-114.5 101.5,-114.5 101.5,-126.5 101.5,-126.5 101.5,-132.5 95.5,-138.5 89.5,-138.5"/>
<text text-anchor="middle" x="50.75" y="-115.45" font-family="Times New Roman,serif" font-size="14.00">gen_batch_plan</text>
</g>
<!-- plan -->
<g id="node2" class="node">
<title>plan</title>
<path fill="none" stroke="black" d="M217.79,-241.35C217.79,-241.35 201.58,-233.65 201.58,-233.65 196.17,-231.08 196.17,-225.92 201.58,-223.35 201.58,-223.35 217.79,-215.65 217.79,-215.65 223.21,-213.08 234.04,-213.08 239.46,-215.65 239.46,-215.65 255.67,-223.35 255.67,-223.35 261.08,-225.92 261.08,-231.08 255.67,-233.65 255.67,-233.65 239.46,-241.35 239.46,-241.35 234.04,-243.92 223.21,-243.92 217.79,-241.35"/>
<text text-anchor="middle" x="228.62" y="-223.45" font-family="Times New Roman,serif" font-size="14.00">plan</text>
</g>
<!-- gbl&#45;&gt;plan -->
<g id="edge1" class="edge">
<title>gbl&#45;&gt;plan</title>
<path fill="none" stroke="black" d="M66.85,-138.84C82.85,-157.17 109.75,-184.94 138.5,-201.5 154.09,-210.48 172.98,-216.76 189.34,-220.98"/>
<polygon fill="black" stroke="black" points="188.18,-224.31 198.72,-223.24 189.82,-217.5 188.18,-224.31"/>
</g>
<!-- istie -->
<g id="node5" class="node">
<title>istie</title>
<path fill="none" stroke="black" d="M243.62,-192.5C243.62,-192.5 213.62,-192.5 213.62,-192.5 207.62,-192.5 201.62,-186.5 201.62,-180.5 201.62,-180.5 201.62,-168.5 201.62,-168.5 201.62,-162.5 207.62,-156.5 213.62,-156.5 213.62,-156.5 243.62,-156.5 243.62,-156.5 249.62,-156.5 255.62,-162.5 255.62,-168.5 255.62,-168.5 255.62,-180.5 255.62,-180.5 255.62,-186.5 249.62,-192.5 243.62,-192.5"/>
<text text-anchor="middle" x="228.62" y="-169.45" font-family="Times New Roman,serif" font-size="14.00">istie</text>
</g>
<!-- gbl&#45;&gt;istie -->
<g id="edge4" class="edge">
<title>gbl&#45;&gt;istie</title>
<path fill="none" stroke="black" d="M101.73,-136.13C113.77,-139.87 126.59,-143.84 138.5,-147.5 155.7,-152.78 174.8,-158.58 190.88,-163.44"/>
<polygon fill="black" stroke="black" points="189.45,-166.66 200.03,-166.2 191.47,-159.96 189.45,-166.66"/>
</g>
<!-- const_eval_exprs -->
<g id="node6" class="node">
<title>const_eval_exprs</title>
<path fill="none" stroke="black" d="M271.5,-138.5C271.5,-138.5 185.75,-138.5 185.75,-138.5 179.75,-138.5 173.75,-132.5 173.75,-126.5 173.75,-126.5 173.75,-114.5 173.75,-114.5 173.75,-108.5 179.75,-102.5 185.75,-102.5 185.75,-102.5 271.5,-102.5 271.5,-102.5 277.5,-102.5 283.5,-108.5 283.5,-114.5 283.5,-114.5 283.5,-126.5 283.5,-126.5 283.5,-132.5 277.5,-138.5 271.5,-138.5"/>
<text text-anchor="middle" x="228.62" y="-115.45" font-family="Times New Roman,serif" font-size="14.00">const_eval_exprs</text>
</g>
<!-- gbl&#45;&gt;const_eval_exprs -->
<g id="edge5" class="edge">
<title>gbl&#45;&gt;const_eval_exprs</title>
<path fill="none" stroke="black" d="M101.68,-120.5C120.35,-120.5 141.86,-120.5 161.76,-120.5"/>
<polygon fill="black" stroke="black" points="161.74,-124 171.74,-120.5 161.74,-117 161.74,-124"/>
</g>
<!-- tbwor -->
<g id="node7" class="node">
<title>tbwor</title>
<path fill="none" stroke="red" d="M150.5,-35C150.5,-35 306.75,-35 306.75,-35 312.75,-35 318.75,-41 318.75,-47 318.75,-47 318.75,-72 318.75,-72 318.75,-78 312.75,-84 306.75,-84 306.75,-84 150.5,-84 150.5,-84 144.5,-84 138.5,-78 138.5,-72 138.5,-72 138.5,-47 138.5,-47 138.5,-41 144.5,-35 150.5,-35"/>
<text text-anchor="middle" x="228.62" y="-66.7" font-family="Times New Roman,serif" font-size="14.00">Trait ToBatch</text>
<polyline fill="none" stroke="red" points="138.5,-59.5 318.75,-59.5"/>
<text text-anchor="middle" x="228.62" y="-42.2" font-family="Times New Roman,serif" font-size="14.00">to_batch_with_order_required</text>
</g>
<!-- gbl&#45;&gt;tbwor -->
<g id="edge6" class="edge">
<title>gbl&#45;&gt;tbwor</title>
<path fill="none" stroke="black" d="M101.68,-103.18C115.16,-98.51 130.12,-93.32 144.89,-88.2"/>
<polygon fill="black" stroke="black" points="145.85,-91.57 154.15,-84.98 143.55,-84.95 145.85,-91.57"/>
</g>
<!-- obr -->
<g id="node9" class="node">
<title>obr</title>
<polygon fill="red" stroke="red" points="1043.5,-0.5 1043.5,-36.5 1160.75,-36.5 1160.75,-0.5 1043.5,-0.5"/>
<text text-anchor="middle" x="1102.12" y="-13.7" font-family="Times New Roman,serif" font-size="14.00">optimize_by_rules</text>
</g>
<!-- gbl&#45;&gt;obr -->
<g id="edge12" class="edge">
<title>gbl&#45;&gt;obr</title>
<path fill="none" stroke="black" d="M63.13,-102.32C77.79,-80.5 105.36,-44.49 138.5,-25.5 173.64,-5.36 187.12,-6.5 227.62,-6.5 227.62,-6.5 227.62,-6.5 893,-6.5 939.38,-6.5 991.48,-9.51 1031.95,-12.51"/>
<polygon fill="black" stroke="black" points="1031.56,-15.99 1041.8,-13.26 1032.1,-9.01 1031.56,-15.99"/>
</g>
<!-- golpfb -->
<g id="node3" class="node">
<title>golpfb</title>
<path fill="none" stroke="red" d="M728.5,-246.5C728.5,-246.5 523.5,-246.5 523.5,-246.5 517.5,-246.5 511.5,-240.5 511.5,-234.5 511.5,-234.5 511.5,-222.5 511.5,-222.5 511.5,-216.5 517.5,-210.5 523.5,-210.5 523.5,-210.5 728.5,-210.5 728.5,-210.5 734.5,-210.5 740.5,-216.5 740.5,-222.5 740.5,-222.5 740.5,-234.5 740.5,-234.5 740.5,-240.5 734.5,-246.5 728.5,-246.5"/>
<text text-anchor="middle" x="626" y="-223.45" font-family="Times New Roman,serif" font-size="14.00">gen_optimized_logical_plan_for_batch</text>
</g>
<!-- plan&#45;&gt;golpfb -->
<g id="edge2" class="edge">
<title>plan&#45;&gt;golpfb</title>
<path fill="none" stroke="black" d="M267.54,-228.5C320.61,-228.5 419.57,-228.5 499.93,-228.5"/>
<polygon fill="black" stroke="black" points="499.63,-232 509.63,-228.5 499.63,-225 499.63,-232"/>
<text text-anchor="middle" x="415.12" y="-231.7" font-family="Times New Roman,serif" font-size="14.00">PlanPhase::Logical</text>
</g>
<!-- panic -->
<g id="node4" class="node">
<title>panic</title>
<path fill="none" stroke="black" d="M641,-300.5C641,-300.5 611,-300.5 611,-300.5 605,-300.5 599,-294.5 599,-288.5 599,-288.5 599,-276.5 599,-276.5 599,-270.5 605,-264.5 611,-264.5 611,-264.5 641,-264.5 641,-264.5 647,-264.5 653,-270.5 653,-276.5 653,-276.5 653,-288.5 653,-288.5 653,-294.5 647,-300.5 641,-300.5"/>
<text text-anchor="middle" x="626" y="-277.45" font-family="Times New Roman,serif" font-size="14.00">panic</text>
</g>
<!-- plan&#45;&gt;panic -->
<g id="edge3" class="edge">
<title>plan&#45;&gt;panic</title>
<path fill="none" stroke="black" d="M255.5,-234.17C277.13,-238.77 308.84,-245.17 336.75,-249.5 426.25,-263.37 532.23,-274.04 587.38,-279.16"/>
<polygon fill="black" stroke="black" points="586.89,-282.63 597.17,-280.06 587.53,-275.66 586.89,-282.63"/>
<text text-anchor="middle" x="415.12" y="-305.85" font-family="Times New Roman,serif" font-size="14.00">Batch</text>
<text text-anchor="middle" x="415.12" y="-289.35" font-family="Times New Roman,serif" font-size="14.00">OptimizedLogicalForStream</text>
<text text-anchor="middle" x="415.12" y="-272.85" font-family="Times New Roman,serif" font-size="14.00">Stream</text>
</g>
<!-- lggolpfb -->
<g id="node8" class="node">
<title>lggolpfb</title>
<path fill="none" stroke="black" d="M789.5,-119C789.5,-119 994.5,-119 994.5,-119 1000.5,-119 1006.5,-125 1006.5,-131 1006.5,-131 1006.5,-156 1006.5,-156 1006.5,-162 1000.5,-168 994.5,-168 994.5,-168 789.5,-168 789.5,-168 783.5,-168 777.5,-162 777.5,-156 777.5,-156 777.5,-131 777.5,-131 777.5,-125 783.5,-119 789.5,-119"/>
<text text-anchor="middle" x="892" y="-150.7" font-family="Times New Roman,serif" font-size="14.00">LogicalOptimizer</text>
<polyline fill="none" stroke="black" points="777.5,-143.5 1006.5,-143.5"/>
<text text-anchor="middle" x="892" y="-126.2" font-family="Times New Roman,serif" font-size="14.00">gen_optimized_logical_plan_for_batch</text>
</g>
<!-- golpfb&#45;&gt;lggolpfb -->
<g id="edge7" class="edge">
<title>golpfb&#45;&gt;lggolpfb</title>
<path fill="none" stroke="black" d="M710.41,-210.01C720.6,-207.36 730.83,-204.5 740.5,-201.5 767.3,-193.19 796.17,-182.5 821.39,-172.57"/>
<polygon fill="black" stroke="black" points="822.55,-175.87 830.55,-168.93 819.96,-169.37 822.55,-175.87"/>
</g>
<!-- rer -->
<g id="node11" class="node">
<title>rer</title>
<path fill="none" stroke="black" d="M687.25,-138.5C687.25,-138.5 564.75,-138.5 564.75,-138.5 558.75,-138.5 552.75,-132.5 552.75,-126.5 552.75,-126.5 552.75,-114.5 552.75,-114.5 552.75,-108.5 558.75,-102.5 564.75,-102.5 564.75,-102.5 687.25,-102.5 687.25,-102.5 693.25,-102.5 699.25,-108.5 699.25,-114.5 699.25,-114.5 699.25,-126.5 699.25,-126.5 699.25,-132.5 693.25,-138.5 687.25,-138.5"/>
<text text-anchor="middle" x="626" y="-115.45" font-family="Times New Roman,serif" font-size="14.00">rewrite_exprs_recursive</text>
</g>
<!-- istie&#45;&gt;rer -->
<g id="edge11" class="edge">
<title>istie&#45;&gt;rer</title>
<path fill="none" stroke="black" d="M255.87,-170.92C313.1,-163.1 451.18,-144.24 541.29,-131.93"/>
<polygon fill="black" stroke="black" points="541.64,-135.42 551.07,-130.6 540.69,-128.48 541.64,-135.42"/>
</g>
<!-- visit_expr_recursive -->
<g id="node12" class="node">
<title>visit_expr_recursive</title>
<path fill="none" stroke="black" d="M677.12,-192.5C677.12,-192.5 574.88,-192.5 574.88,-192.5 568.88,-192.5 562.88,-186.5 562.88,-180.5 562.88,-180.5 562.88,-168.5 562.88,-168.5 562.88,-162.5 568.88,-156.5 574.88,-156.5 574.88,-156.5 677.12,-156.5 677.12,-156.5 683.12,-156.5 689.12,-162.5 689.12,-168.5 689.12,-168.5 689.12,-180.5 689.12,-180.5 689.12,-186.5 683.12,-192.5 677.12,-192.5"/>
<text text-anchor="middle" x="626" y="-169.45" font-family="Times New Roman,serif" font-size="14.00">visit_expr_recursive</text>
</g>
<!-- istie&#45;&gt;visit_expr_recursive -->
<g id="edge10" class="edge">
<title>istie&#45;&gt;visit_expr_recursive</title>
<path fill="none" stroke="black" d="M255.87,-174.5C315.19,-174.5 461.37,-174.5 550.96,-174.5"/>
<polygon fill="black" stroke="black" points="550.89,-178 560.89,-174.5 550.89,-171 550.89,-178"/>
</g>
<!-- const_eval_exprs&#45;&gt;rer -->
<g id="edge9" class="edge">
<title>const_eval_exprs&#45;&gt;rer</title>
<path fill="none" stroke="black" d="M283.77,-120.5C350.19,-120.5 463.51,-120.5 541.21,-120.5"/>
<polygon fill="black" stroke="black" points="540.89,-124 550.89,-120.5 540.89,-117 540.89,-124"/>
</g>
<!-- tb -->
<g id="node10" class="node">
<title>tb</title>
<path fill="none" stroke="red" d="M592.5,-35C592.5,-35 659.5,-35 659.5,-35 665.5,-35 671.5,-41 671.5,-47 671.5,-47 671.5,-72 671.5,-72 671.5,-78 665.5,-84 659.5,-84 659.5,-84 592.5,-84 592.5,-84 586.5,-84 580.5,-78 580.5,-72 580.5,-72 580.5,-47 580.5,-47 580.5,-41 586.5,-35 592.5,-35"/>
<text text-anchor="middle" x="626" y="-66.7" font-family="Times New Roman,serif" font-size="14.00">Trait ToBatch</text>
<polyline fill="none" stroke="red" points="580.5,-59.5 671.5,-59.5"/>
<text text-anchor="middle" x="626" y="-42.2" font-family="Times New Roman,serif" font-size="14.00">to_batch</text>
</g>
<!-- tbwor&#45;&gt;tb -->
<g id="edge13" class="edge">
<title>tbwor&#45;&gt;tb</title>
<path fill="none" stroke="black" d="M318.85,-59.5C395.55,-59.5 503.81,-59.5 568.92,-59.5"/>
<polygon fill="black" stroke="black" points="568.66,-63 578.66,-59.5 568.66,-56 568.66,-63"/>
</g>
<!-- lggolpfb&#45;&gt;obr -->
<g id="edge8" class="edge">
<title>lggolpfb&#45;&gt;obr</title>
<path fill="none" stroke="black" d="M934.62,-118.5C971.27,-96.49 1024.31,-64.63 1060.63,-42.82"/>
<polygon fill="black" stroke="black" points="1062.33,-45.88 1069.1,-37.74 1058.72,-39.88 1062.33,-45.88"/>
</g>
<!-- optimize_by_rules_inner -->
<g id="node13" class="node">
<title>optimize_by_rules_inner</title>
<path fill="none" stroke="black" d="M1337.5,-36.5C1337.5,-36.5 1209.75,-36.5 1209.75,-36.5 1203.75,-36.5 1197.75,-30.5 1197.75,-24.5 1197.75,-24.5 1197.75,-12.5 1197.75,-12.5 1197.75,-6.5 1203.75,-0.5 1209.75,-0.5 1209.75,-0.5 1337.5,-0.5 1337.5,-0.5 1343.5,-0.5 1349.5,-6.5 1349.5,-12.5 1349.5,-12.5 1349.5,-24.5 1349.5,-24.5 1349.5,-30.5 1343.5,-36.5 1337.5,-36.5"/>
<text text-anchor="middle" x="1273.62" y="-13.45" font-family="Times New Roman,serif" font-size="14.00">optimize_by_rules_inner</text>
</g>
<!-- obr&#45;&gt;optimize_by_rules_inner -->
<g id="edge14" class="edge">
<title>obr&#45;&gt;optimize_by_rules_inner</title>
<path fill="none" stroke="black" d="M1160.98,-18.5C1169.03,-18.5 1177.43,-18.5 1185.86,-18.5"/>
<polygon fill="black" stroke="black" points="1185.83,-22 1195.83,-18.5 1185.83,-15 1185.83,-22"/>
</g>
<!-- optimize -->
<g id="node14" class="node">
<title>optimize</title>
<path fill="none" stroke="red" d="M1438.5,-36.5C1438.5,-36.5 1398.5,-36.5 1398.5,-36.5 1392.5,-36.5 1386.5,-30.5 1386.5,-24.5 1386.5,-24.5 1386.5,-12.5 1386.5,-12.5 1386.5,-6.5 1392.5,-0.5 1398.5,-0.5 1398.5,-0.5 1438.5,-0.5 1438.5,-0.5 1444.5,-0.5 1450.5,-6.5 1450.5,-12.5 1450.5,-12.5 1450.5,-24.5 1450.5,-24.5 1450.5,-30.5 1444.5,-36.5 1438.5,-36.5"/>
<text text-anchor="middle" x="1418.5" y="-13.45" font-family="Times New Roman,serif" font-size="14.00">optimize</text>
</g>
<!-- optimize_by_rules_inner&#45;&gt;optimize -->
<g id="edge15" class="edge">
<title>optimize_by_rules_inner&#45;&gt;optimize</title>
<path fill="none" stroke="black" d="M1349.83,-18.5C1358.31,-18.5 1366.72,-18.5 1374.58,-18.5"/>
<polygon fill="black" stroke="black" points="1374.51,-22 1384.51,-18.5 1374.51,-15 1374.51,-22"/>
</g>
</g>
</svg>
